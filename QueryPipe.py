from RunApi import *

def main():
    open_ai_client, pinecone = connections()
    status = False
    all_responses_retrieved, all_embeds_retreived = [], []
    while True:
        user_input = input("What do you want to learn more about?: ")

        # Exit the program loop
        if user_input.lower() == 'exit':
            break    

        # If user is done with follow up questions, flush local context and treat next question as a base query
        if user_input.lower() == 'done':
            status = False
            all_responses_retrieved.clear()
            all_embeds_retreived.clear()
            continue
        
        # Base query
        if status == False:
            # Rag Fusion
            finalized_response, all_responses_retrieved, all_embeds_retreived = main_question(user_input, open_ai_client, pinecone, PINECONE_NAMESPACE, PINECONE_BUCKET)
            
            print("------- Finalized Response ----------")
            print(finalized_response)
            print("---------------------------------")
            
            # print("-------- Supporting Texts -----------")
            # print(all_responses_retrieved)
            # print("---------------------------------")
            status = True
        else:
            # Follow Up Questions
            print(follow_up_question(user_input, all_embeds_retreived, all_responses_retrieved, open_ai_client))

# The main entry point of the program
if __name__ == "__main__":
    main()




